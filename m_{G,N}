#c computes conjugacy classes of subgroups
c:=function(n,G)
	local cc;
	cc:=ConjugacyClassesSubgroups(G);
	return ConjugateSubgroups(G,Representative(cc[n]));
	end;;

#computes whether a subgroup H is in K
H_in_K:=function(H,K)
	if IsSubgroup(K,H)=true then
		return 1;
	else
		return 0;
	fi;
end;;

#computes subgroups of G	
sub:=function(G)
	local list,i,cc;
	list:=[ ];
	i:=1;
	cc:=Size(ConjugacyClassesSubgroups(G));
	while i<=cc do
		Append(list, c(i,G));
		i:=i+1;
	od;
	return list;
end;;

sub_XG:=function(X,G)
	local subG,i,list;
	subG:=sub(G);
	list:=[];
	for i in subG do
		if IsSubgroup(i,X)=true then
			Add(list, i);
		fi;
  od;
	return list;
end;;

#computes the rows of the zeta function matrix for subgroups
row_sub:=function(i,G,sub_g)
	local list,j;
	list:=[ ];
	for j in sub_g do
		Add(list,H_in_K(sub_g[i],j));
	od;
	return list;
end;;

#puts these together to create the zeta matrix
zeta_sub:=function(X,G)
	local i, zeta_mat,size_sub,sub_g;
	sub_g:=sub_XG(X,G);
	size_sub:=Size(sub_g);
	zeta_mat:=[ ];
	i:=1;
	while i<=size_sub do
		Add(zeta_mat,row_sub(i,G,sub_g));
		i:=i+1;
	od;
	return zeta_mat;
end;;

#takes inverse to compute mobius function
mobius_sub:=function(X,G)
	local s,mobius_mat;
	s:=Size(sub_XG(X,G));
	mobius_mat:=Inverse(zeta_sub(X,G));
	return (mobius_mat[1])[s];
end;;

